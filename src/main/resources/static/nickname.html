<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>닉네임 수정</title>
    <style>
        body { font-family: sans-serif; margin: 2rem; }
        input, button { margin: 1rem 0; display: block; }
        #message { color: red; }
    </style>
</head>
<body>
<h1>닉네임 수정</h1>

<input id="nickname" placeholder="새 닉네임 입력" />
<button id="update-btn">닉네임 저장</button>

<p id="message"></p>

<script>
    document.getElementById('update-btn').onclick = async () => {
        const nickname = document.getElementById('nickname').value;
        const messageEl = document.getElementById('message');
        messageEl.innerText = '';

        if (!nickname) {
            messageEl.innerText = '닉네임을 입력해주세요.';
            return;
        }

        try {
            const res = await fetch('http://43.201.121.201/mypage/user-nickname', {
                method: 'PATCH',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ nickname: nickname })
            });

            const data = await res.json();

            if (res.ok) {
                alert('닉네임이 성공적으로 변경되었습니다.');
                window.location.href = 'http://43.201.121.201/home.html';
            } else {
                messageEl.innerText = data.message || '닉네임 변경 실패';
            }
        } catch (e) {
            console.error(e);
            messageEl.innerText = '서버 오류가 발생했습니다.';
        }
    };
</script>
</body>
</html>
